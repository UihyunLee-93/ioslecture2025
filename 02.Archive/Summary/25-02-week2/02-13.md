# UserDefaults란?

## 개요

**UserDefaults**는 Swift에서 제공하는 기본 데이터 저장 방식으로, **간단한 키-값 데이터를 앱에서 지속적으로 저장할 수 있도록 지원**합니다.  
주로 **사용자 설정, 앱 환경 설정, 간단한 데이터 유지**에 사용됩니다.

## UserDefaults 사용 시기

- **적절한 사용 사례**:
  - 사용자의 환경 설정 (예: 다크 모드, 언어 설정)
  - 앱 상태 유지 (예: 마지막으로 방문한 화면 정보)
  - 간단한 설정 값 저장 (예: 자동 로그인 여부, 음량 설정)

- **부적절한 사용 사례**:
  - **대용량 데이터 저장** (UserDefaults는 빠른 조회를 위한 간단한 데이터 저장 용도로만 적합)
  - **민감한 정보 저장** (비밀번호, 개인 정보 등은 Keychain을 사용할 것)
  - **실시간 데이터 처리** (자주 변경되는 데이터는 별도 저장소 필요)

## UserDefaults 사용법

1. **데이터 저장**:
   - `set` 메서드를 사용하여 특정 키에 데이터를 저장할 수 있음.
   - 지원되는 데이터 유형: `String`, `Int`, `Bool`, `Double`, `Float`, `URL`, `Array`, `Dictionary` 등.

2. **데이터 불러오기**:
   - `string(forKey:)`, `integer(forKey:)` 등 적절한 메서드를 사용하여 데이터 조회.
   - 값이 없을 경우를 대비해 기본값을 설정하는 것이 중요.

3. **데이터 삭제**:
   - `removeObject(forKey:)` 메서드를 사용하여 특정 키의 데이터를 제거.

## UserDefaults 사용 시 주의할 점

- **키 관리**:
  - 하드코딩을 피하기 위해 `enum`이나 `struct`를 활용하여 키 값을 상수로 관리하는 것이 좋음.

- **동기화 문제**:
  - iOS에서는 `synchronize()`를 수동으로 호출할 필요 없이 자동 저장됨.
  - 하지만 특정 시점에서 강제 저장이 필요할 경우, `UserDefaults.standard.synchronize()`를 호출할 수 있음.

- **스레드 안전성**:
  - UserDefaults는 **스레드 안전(Thread-safe)** 하지만, 너무 많은 읽기/쓰기 작업을 동시에 하면 성능 저하가 발생할 수 있음.

## UserDefaults의 한계

- **저장 용량 제한**:
  - **대량의 데이터를 저장하면 성능 저하가 발생할 수 있음** (몇 KB~MB 정도의 작은 데이터 저장에 적합).

- **저장 가능한 데이터 유형**:
  - **직렬화(Encoding) 없이 커스텀 객체를 저장할 수 없음**.  
    (→ `Codable` 프로토콜을 사용해 `Data` 타입으로 변환 후 저장해야 함)

- **보안 문제**:
  - UserDefaults에 저장된 데이터는 **암호화되지 않으며, 탈옥된 기기에서는 쉽게 접근 가능**.
  - **비밀번호, 사용자 인증 정보는 절대 저장하면 안 됨!**  
    (→ 민감한 데이터는 **Keychain** 사용)

## UserDefaults의 대안

- **Core Data**:
  - 복잡한 데이터 모델을 다룰 때 사용.
  - 관계형 데이터베이스처럼 다수의 객체를 관리할 수 있음.

- **FileManager**:
  - 문서, 이미지, JSON 파일과 같은 파일 기반 데이터를 저장할 때 적합.

이처럼 **UserDefaults는 간단한 데이터를 빠르게 저장할 때 적합하지만, 대량 데이터나 민감한 정보 저장에는 적절하지 않으므로 상황에 맞는 저장 방식을 선택해야 합니다.**


#  FileManager를 활용한 데이터 저장

##  개요

**FileManager**는 Swift에서 파일을 저장하고 불러올 때 사용하는 기본 기능이다.  
앱에서 생성한 데이터를 문서 디렉토리(Document Directory)나 캐시 디렉토리(Cache Directory)에 저장하고, 필요할 때 다시 불러오는 데 활용된다.  
이미지, JSON 파일, 텍스트 데이터 등을 저장하는 데 유용하다.

---

##  FileManager의 역할

###  FileManager란?
- iOS에서 파일과 디렉토리를 **생성, 삭제, 이동, 복사**하는 역할을 한다.
- 앱이 생성한 데이터를 저장하는 **문서 디렉토리(Document Directory)**를 관리한다.
- JSON 파일, 이미지, 텍스트 파일 등을 **로컬에 저장하고 관리**하는 데 적합하다.

---

##  파일 저장 위치

파일을 저장할 경로는 보통 **문서 디렉토리(Document Directory)**를 사용한다.  
이 경로는 앱이 삭제되지 않는 한 유지되며, 중요한 데이터를 저장하는 데 적합하다.

파일 경로를 설정하는 과정:
1. `FileManager.default.urls(for:in:)`을 이용해 **문서 디렉토리의 URL**을 가져온다.
2. `appendingPathComponent`를 사용해 원하는 **파일명을 추가**하여 저장할 경로를 만든다.

---

##  파일 관리 기능

###  파일 저장 (쓰기)

파일을 생성하고 데이터를 저장하는 기능이다.

**활용 예시**
- 네트워크에서 받은 JSON 데이터를 저장해 오프라인에서도 사용
- 앱 설정값을 파일에 저장해 유지
- 텍스트 노트 등을 로컬 파일로 저장

###  파일 읽기

저장된 파일을 불러오는 기능이다.

**활용 예시**
- JSON 파일을 읽어와 데이터를 파싱
- 저장된 설정 값을 불러와 UI에 반영
- 사용자가 저장한 텍스트 파일을 불러오기

###  파일 삭제

더 이상 필요 없는 파일을 제거하는 기능이다.

**활용 예시**
- 캐시 파일을 주기적으로 정리해 저장 공간 확보
- 사용하지 않는 데이터 삭제로 앱 용량 최적화

---

##  활용 예시

| 사용 사례 | 설명 |
|-----------|------------------------------------------------|
|  **JSON 파일 저장** | 네트워크에서 받은 JSON 데이터를 로컬에 저장해 오프라인에서도 활용 |
|  **이미지 저장** | 사용자가 업로드한 이미지를 로컬에 저장해 빠르게 접근 가능 |
|  **텍스트 파일 저장** | 사용자 노트, 앱 설정 정보를 파일로 저장해 유지 |
|  **데이터 백업** | 앱의 중요한 데이터를 백업해 데이터 손실 방지 |

---

## 주의할 점

- **보안 문제**  
  - 비밀번호나 개인 정보 같은 민감한 데이터는 **FileManager가 아닌 Keychain**을 사용해 저장하는 게 안전하다.
  
- **저장 위치 선택**  
  - **문서 디렉토리**: 앱이 삭제되기 전까지 데이터를 유지하고 싶을 때 사용
  - **캐시 디렉토리**: 앱이 삭제되면 자동으로 제거되므로 임시 데이터 저장용

- **파일 용량 관리**  
  - 너무 많은 데이터를 저장하면 앱의 성능이 저하될 수 있다. 필요 없는 파일은 삭제하는 게 좋다.

---

## 정리

FileManager를 사용하면 앱에서 파일을 쉽게 저장하고 관리할 수 있다.  
JSON 파일, 이미지, 텍스트 파일 등을 저장하는 데 적합하며, 저장 위치에 따라 데이터 유지 여부가 달라지므로 목적에 맞게 활용하는 게 중요하다.
